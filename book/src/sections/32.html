<section id='game-click'>
  <div class='grid'>
    <div class='text'>
      <h2>
        –ü—Ä–∏–≤—è–∂–µ–º –∫–ª–∏–∫ –∫ –∏–≥—Ä–µ
        <a href='#game-click' class='anchor'>üîó</a>
      </h2>
    </div>
  </div>

  <div class='grid'>
    <div class='text'>
      <p>–¢–µ–ø–µ—Ä—å –ø—Ä–∏–≤—è–∂–µ–º –∫–ª–∏–∫ –∫ –∏–≥—Ä–µ. –°–¥–µ–ª–∞–µ–º, —á—Ç–æ–±—ã –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–ª–µ—Ç–∫—É –≤ –∏–≥—Ä–µ –ø—Ä–æ—Å—Ç–∞–≤–ª—è–ª—Å—è –∫—Ä–µ—Å—Ç–∏–∫ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∫–ª–µ—Ç–∫–µ –¥–æ—Å–∫–∏.</p>
      <p>–£ –Ω–∞—Å –µ—Å—Ç—å –º–µ—Ç–æ–¥ <i>acceptUserMove</i> —É –∫–ª–∞—Å—Å–∞ <i>Game</i>, –∫–æ—Ç–æ—Ä—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É —Ö–æ–¥–∞ –∏–≥—Ä–æ–∫–∞. –ü—Ä–æ–≤–µ—Ä–∏–º, —á—Ç–æ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —è—á–µ–π–∫—É —Ç–∞–±–ª–∏—Ü—ã –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —ç—Ç–æ—Ç –º–µ—Ç–æ–¥.</p>
      <p>–î–ª—è —ç—Ç–æ–≥–æ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å <a href='https://gaboesquivel.com/blog/2014/unit-testing-mocks-stubs-and-spies/'>—à–ø–∏–æ–Ω–∞ (spy)</a>. –ú—ã —Å–≤—è–∂–µ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Å –º–æ–¥–µ–ª—å—é –∏–≥—Ä—ã, –≤ –∫–æ—Ç–æ—Ä–æ–π –∑–∞–º–µ–Ω–∏–º –º–µ—Ç–æ–¥ <i>acceptUserMove</i> –Ω–∞ —à–ø–∏–æ–Ω–∞. –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä–∏–º, –±—ã–ª –ª–∏ –æ–Ω –≤—ã–∑–≤–∞–Ω.</p>
      <p>–î–ª—è —ç—Ç–æ–≥–æ –∏–∑–º–µ–Ω–∏–º –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞, —á—Ç–æ–±—ã –æ–Ω –ø—Ä–∏–Ω–∏–º–∞–ª –Ω–µ —Ç–æ–ª—å–∫–æ —Å–µ–ª–µ–∫—Ç–æ—Ä, –Ω–æ –µ—â—ë –∏ –º–æ–¥–µ–ª—å –∏–≥—Ä—ã, –∫ –∫–æ—Ç–æ—Ä–æ–π –º—ã –µ–≥–æ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ–º.</p>
      <p>–ü—Ä–∏ –∫–ª–∏–∫–µ –±—É–¥–µ–º –≤—ã–∑—ã–≤–∞—Ç—å –º–µ—Ç–æ–¥ <i>acceptUserMove</i>, –ø–µ—Ä–µ–¥–∞–≤–∞—è –≤ –Ω–µ–≥–æ –∏–Ω–¥–µ–∫—Å—ã —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–ª–æ–Ω–∫–∏, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –∫–ª–∏–∫–Ω—É–ª–∏.</p>
    </div>

    <div class='code'>
<pre data-start='3'><div class='code-filename'>test/dom.js</div><code class='language-js line-numbers'>import sinon from 'sinon'

// ...

const createInstance = (game={}) => {
  return new DomController({
    game: game,
    root: '#root'
  })
}

// ...

  it('Makes user move in game on cell click', () => {
    const gameMock = { acceptUserMove: sinon.spy() }
    const domController = createInstance(gameMock)

    domController.createTable(3, 3)
    document.querySelector('table td').click()

    expect(domController.game.acceptUserMove.called).to.be.true
  })</code></pre>

<pre><div class='code-filename'>src/DomController.js</div><code class='language-diff line-numbers'>  class DomController {
-   constructor(root) {
+   constructor({root, game}) {
+     this.game = game
      this.rootNode = document.querySelector(root)
      this.lastClickedIndecies = [-1, -1]
    }
  } 

  // ...

  _handleCellClick(row, col) {
    this.lastClickedIndecies = [row, col]
+   this.game.acceptUserMove(row, col)
  }</code></pre>
    </div>
  </div>

  <div class='grid'>
    <div class='text'>
      <p>–ö–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ö–æ–¥–∞, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏ –∏–≥—Ä—ã, –≤—ã–Ω–µ—Å–µ–º –≤–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π –º–µ—Ç–æ–¥ <i>_makeUserMove</i>.</p>
      <p>–í—Å–ø–æ–º–∏–Ω–∞–µ–º, —á—Ç–æ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∑–∞–Ω—è—Ç—É—é –∫–ª–µ—Ç–∫—É —É –Ω–∞—Å –ø–æ—è–≤–∏—Ç—Å—è –æ—à–∏–±–∫–∞. –ü–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º <i>try-catch</i>, —á—Ç–æ–±—ã –ª–æ–≤–∏—Ç—å –∏—Ö.</p>
    </div>

    <div class='code'>
<pre data-start='24'><div class='code-filename'>src/DomController.js</div><code class='language-diff line-numbers'>  _handleCellClick(row, col) {
    this.lastClickedIndecies = [row, col]
-   this.game.acceptUserMove(row, col)

+   try {
+     this._makeUserMove(row, col)
+   }
+   catch(e) {
+     window.alert(e.message)
+   }
+ }
+
+ _makeUserMove(row, col) {
+   this.game.acceptUserMove(row, col)
+ }</code></pre>
    </div>
  </div>
</section>